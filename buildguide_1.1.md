# suika27melo ビルドガイド

## はじめに
このたびはsuika27meloをお求めいただきありがとうございます。  
このドキュメントでは、このキーボードの組み立てから使用できるようになるまでの一連の流れを解説します。  

## 用意するもの

### 同梱物
* プレート類（2種類）
  * メインボード 1枚
    * 部品をハンダ付けするメインとなる基板です。  
      ![parts1](img/parts1.jpg)
  * バックプレート 1枚
    * キーボードの一番底になる裏板です  
      ![parts2](img/parts2.jpg)
* ねじ類（3種類）
  * M2 x 3mm なべ小ねじ 20本（+ 予備1本）  
     ![parts3](img/parts3.jpg)  
  * M2 x 3.5mm 両めねじ スペーサ 10本（+ 予備1本）  
     ![parts4](img/parts4.jpg)  
* ゴム足
  * 高さ 約5mm 6個（お好みで背面に貼り付けてお使いください）  
     ![parts5](img/parts5.jpg)  
  
もし不足する部品等がありましたら Twitter(X) [@suikagiken](https://x.com/suikagiken) のDMまでご連絡ください

### 別途用意が必要な部品
* キースイッチ 27個
  * Cherry MXスイッチ または Kailh Choc V1ロープロファイルスイッチ 互換の5ピンまたは3ピンのものが使用可能です。
    * Kailh Choc V2ロープロファイルスイッチのピン形状のスイッチは使えません。
    * ホットスワップ用キーソケットは使えません。
* 1u キーキャップ 27個
  * お選びのキースイッチに対応したキーキャップをご用意ください。どのプロファイルでもOKです。
* USB Type-C ケーブル

### 必要な工具
工具は電子工作用として一般的なものでも十分ですが、お持ちでない場合や、お手元の工具が不安な場合、下記にあげたものがお勧めの一例です。いずれも秋月電子通商やアマゾンで購入できます。
* ハンダゴテ
  * 温度調節機能の付いたものをお勧めします
    * 白光 FX-600 （[秋月電子](https://akizukidenshi.com/catalog/g/g114456/)）
* 糸ハンダ
  * 0.65~0.8mm程度の細さのものがお勧めです。また、鉛フリーハンダは扱いが難しいため慣れない方にはお勧めしません
    * ヤニ入りハンダ 0.65mm （[秋月電子](https://akizukidenshi.com/catalog/g/g109556/)）
* ハンダ吸い取り線
  * 取り付けミスがなければ不要ですが、用意があると安心です
    * ハンダ吸い取り線 3mm （[秋月電子](https://akizukidenshi.com/catalog/g/g102539/)）
* 精密ドライバー
  * M2のねじが止められるNo.0のプラスドライバーが必要です
    * 精密ドライバーセット （[秋月電子](https://akizukidenshi.com/catalog/g/g118343/)）

## 組み立て

### (1) メインボードへのねじ・スペーサの取り付け
メインボードには、まずねじとスペーサを先に取り付けておくとあとの工程が容易です。  
最初にボードの裏表を確認します。部品が実装されていない面が「表」、チップ部品などが多数実装されている面が「裏」です。  
  ![screw1](img/screw1.jpg)  
1. 表側からM2 x 3mm なべ小ねじをあてがう
2. 裏側からM2 x 3.5mm 両めねじ スペーサを手でねじ込む
3. スペーサを押さえながら、ドライバーで増し締めする  
   下の写真のように全部のねじが取り付けられればOKです。  
  ![screw2](img/screw2.jpg)  

### (2) キースイッチの取り付け・ハンダ付け
最初にキースイッチを表側から配置しますが、この際、位置決めを慎重に行ってください。5ピンのスイッチを使用する場合は比較的容易ですが、3ピンのスイッチの場合、ピンの遊びでキーが揃いにくくなりますのでハンダ付け時に注意が必要です。
1. メインボードの穴にキースイッチをしっかり奥まで差し込む  
   このとき、少しでもプレートから浮いているとゆがみにつながります。しっかりとプレートにはまったことを確認してください。
   ![switch1](img/switch1.jpg)
2. すべて差し込み終わったら落ちないように板などをあてがいながら、ゆっくり裏返してハンダ面を表にする
3. 27個のキースイッチの2ピンずつをハンダ付けする  
   ハンダ付けの際にももう一度スイッチが浮いていないか確認してください。  
   ![switch2](img/switch2.jpg)


### (3) バックプレートのねじ止め・ゴム足の取り付け
1. メインボードのハンダ面を上にして置き、その上に「すいか技研」の文字のプリントがある方を表にしたバックプレートを重ねる
2. 10か所のねじ穴に、M2 x 3mm なべ小ねじをねじ込む
3. バックプレートの好きな場所にお好みでゴム足を取り付ける  
   ![back](img/back.jpg)

### (4) キーキャップの取り付け
最後に、キースイッチにお好みのキーキャップを取り付けて、組み立ては完了です。  
   ![suika27melo](img/suika27melo_1.jpg)
  
## REMAPの起動・キーマップの編集
いよいよ最後の工程です。REMAPを使ってキーマップを編集します。  
なお、VIAを使ってもキーマップの編集は可能ですが、MIDIキーボードとして使用するための設定をしたい場合はREMAPのほうが便利なため、下記ではREMAPでの方法を解説します。
**REMAPは Chrome または Edge のブラウザでのみ使用できます**。残念ながらFirefoxには対応していませんのでご注意ください。
1. Chrome または Edge ブラウザで https://remap-keys.app/configure にアクセスする
2. USBケーブルでPCにキーボードを接続する
3. **+KEYBOARD** をクリックすると、「remap-keys.appがHIDデバイスへの接続を要求しています」という画面が開くので「suika27melo」を一覧から選択し「接続」をクリックする  
   下図のようにキーボードのデザインが正しく表示されていれば、キーマップの編集準備完了です。  
      ![remap](img/remap.png)

あとはご自身で自由にカスタマイズして便利なキーボードに育ててください！

### ファームウエアの書き換え方
**【通常はこの手順は不要です】**  
この基板にはすでにファームウエアを書き込んであるため、改めてファームウエアを書き込む必要はありません。  
ファームウエアにカスタマイズを加えて使う場合や、もし何らかの理由で誤って消してしまったファームウエアを再度書き込む場合は、次の手順を参考にしてください。  
なお、組み立て済みでバックボードまで取り付けている場合は、Resetボタンにアクセスできるよう、いったんバックボードは外してください。
#### QMK ToolBoxのインストール
1. https://github.com/qmk/qmk_toolbox/releases からQMK Toolboxをダウンロードし、インストールします。
#### suikagiken_suika27melo_default.hex の書き込み
1. [すいか技研のリポジトリ](https://github.com/suikagiken/suika27melo) のhexフォルダから、ファームウエアのファイル[suikagiken_suika27melo_default.hex をダウンロード](https://github.com/suikagiken/suika27melo/blob/main/hex/suikagiken_suika27melo_default.hex)し、適当な場所に保存する
2. QMK Toolboxを起動し、Openをクリックして下図の①のようにファームウエアファイルを指定する
3. 裏面のResetボタンを押し、ファーム書き込みモードにする  
   ②のメッセージが出たら準備完了です。
4. ③のFlashボタンをクリックして書き込みが終わるのを待つ  
   ④のメッセージが出たら書き込みが完了ですので、ケーブルを抜きます。  
   ![qmktoolbox](img/qmktoolbox.png)

## おわりに
長々としたビルドガイドに最後までお付き合いくださりありがとうございました。  
組み立ての途中や組み立て後のご使用中にトラブルやご不明点がございましたら、お気軽に Twitter [@suikagiken](https://twitter.com/suikagiken) のDMまでご連絡ください。  
引き続きすいか技研をご愛顧くださいますようお願いいたします。

